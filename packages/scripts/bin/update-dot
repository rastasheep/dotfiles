#!/usr/bin/env bash
#
# Update flake inputs and apply dotfiles configuration
#

set -e

dotfiles_dir="$HOME/src/github.com/rastasheep/dotfiles"

echo "→ Updating flake inputs..."
cd "$dotfiles_dir"

# Show current lock info
echo "Current versions:"
nix flake metadata --no-write-lock-file | grep -E "nixpkgs" || true

# Update inputs
nix flake update

echo ""
echo "→ Applying updated configuration..."
nix profile upgrade --impure ".*aleksandars-mbp.*"

echo ""
echo "✓ Dotfiles updated and applied successfully!"
echo ""
echo "Updated versions:"
nix flake metadata --no-write-lock-file | grep -E "nixpkgs" || true